# Step 7: Configuring OSSEC Configuration for Wazuh to Log Everything

This step guides you through configuring your Wazuh server to log all events captured by the agents, ensuring comprehensive logging for your SOC Home Lab. This configuration is particularly useful for detailed monitoring and forensic analysis.

## 1. Backup the OSSEC Configuration File

First, ensure you're SSH'ed into your Wazuh server. Begin by creating a backup of the `ossec.conf` file. This precaution allows you to restore the original configuration if needed.

```bash
cp /var/ossec/etc/ossec.conf ~/ossec-backup.conf
```

## 2. Edit the OSSEC Configuration

1. Open the `ossec.conf` file for editing:
   
   ```bash
   nano /var/ossec/etc/ossec.conf
   ```

2. Inside the `<ossec_config>` section, find or add the lines for `logall` and `logall_json`, setting them to `yes` to enable comprehensive logging:

   ```xml
   <ossec_config>
       ...
       <global>
           ...
           <logall>yes</logall>
           <logall_json>yes</logall_json>
           ...
       </global>
       ...
   </ossec_config>
   ```

3. Save the changes and exit Nano (Ctrl+X, then Y, and Enter to confirm).

## 3. Restart the Wazuh Manager Service

Apply the changes by restarting the Wazuh manager service:

```bash
systemctl restart wazuh-manager.service
```

## 4. Configure Filebeat for Archives Log Ingestion

To enable Wazuh to ingest the comprehensive archives log generated by the above configuration, you need to adjust the Filebeat configuration:

1. Open the Filebeat configuration file:

   ```bash
   nano /etc/filebeat/filebeat.yml
   ```

2. Within the `filebeat.modules` section, ensure the configuration for the archives log is set to enabled. If the section does not exist, add it or modify the existing line appropriately:

   ```yaml
   filebeat.modules:
   - module: wazuh
     archives:
       enabled: true
   ```

3. Save your changes and exit Nano.

## 5. Restart Filebeat

Finally, restart Filebeat to apply the new configuration:

```bash
systemctl restart filebeat
```

By following these steps, your Wazuh server will now log all events in detail, significantly enhancing your SOC Home Lab's logging capabilities. This comprehensive logging approach is invaluable for in-depth analysis and investigations.